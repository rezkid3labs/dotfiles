# ~/.tmux.conf
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",*256col*:Tc"
set -ga terminal-overrides '*:Ss=\E[%p1%d q:Se=\E[ q'
set-environment -g COLORTERM "truecolor"
set -g mouse on
set -g status-style "fg=cyan,bg=black"

set -g escape-time 10
set -g base-index 1
set -g focus-events on
# Renumber windows when one is closed
set -g renumber-windows on

# Increase scrollback buffer size
set -g history-limit 50000


bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

unbind C-b
set -g prefix C-space
bind C-space send-prefix

bind R source-file ~/.config/tmux/tmux.conf \; display-message "tmux-config RELOADED"

# set-option -g status-justify "left"
# # set-option utf8-default on
# set-window-option -g mode-keys vi
# #set-window-option -g utf8 on
# # look'n feel
# set -g status-position top
# set-option -g history-limit 64096
#
# set -sg escape-time 10
#
# # allow the title bar to adapt to whatever host you connect to
# set -g set-titles on
# set -g set-titles-string "#T"
# ============================================
# PANE MANAGEMENT (Intuitive Splits)
# ============================================

# Split panes using | and - (more intuitive than % and ")
unbind %
unbind '"'
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Alternative: Use v and s (Vim-style)
bind v split-window -h -c "#{pane_current_path}"
bind s split-window -v -c "#{pane_current_path}"

# Navigate panes with Alt+Arrow (no prefix needed)
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# Navigate panes with Vim keys (with prefix)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Resize panes with Vim keys (with prefix)
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Resize panes with Shift+Arrow (no prefix needed)
bind -n S-Left resize-pane -L 2
bind -n S-Right resize-pane -R 2
bind -n S-Up resize-pane -U 2
bind -n S-Down resize-pane -D 2

# Close pane with x (will prompt for confirmation)
bind x kill-pane

# Zoom pane toggle (maximize/restore)
bind z resize-pane -Z

# ============================================
# WINDOW MANAGEMENT
# ============================================

# Create new window
bind c new-window -c "#{pane_current_path}"

# Navigate windows with Ctrl+h/l (no prefix)
bind -n C-h previous-window
bind -n C-l next-window

# Alternative: Tab navigation
bind -n M-h previous-window
bind -n M-l next-window

# Move windows left/right
bind -r "<" swap-window -t -1 -d
bind -r ">" swap-window -t +1 -d

# Close window
bind X kill-window

# Rename window
bind r command-prompt -I "#W" "rename-window '%%'"

# ============================================
# SESSION MANAGEMENT
# ============================================

# Create new session
bind C new-session

# Switch sessions with fzf (if available)
bind S choose-session

# Detach from session
bind d detach-client

# ============================================
# COPY MODE (Vim-style)
# ============================================

# Enter copy mode
bind [ copy-mode

# Vi-style copy mode
setw -g mode-keys vi

# Vi-style selection in copy mode
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel
bind -T copy-mode-vi C-v send -X rectangle-toggle

# Paste
bind p paste-buffer

# ============================================
# QUICK ACTIONS (Leader key shortcuts)
# ============================================

# Reload config file

# Clear screen and scrollback
bind C-l send-keys 'C-l' \; clear-history

# Toggle status bar
bind b set-option -g status

# Synchronize panes (send commands to all panes)
bind y setw synchronize-panes \; display "Synchronize: #{?pane_synchronized,ON,OFF}"

# ============================================
# STATUS BAR CUSTOMIZATION
# ============================================

# Status bar position
set -g status-position top

# Status bar colors
set -g status-style bg=colour235,fg=colour137

# Left status (session name)
set -g status-left-length 20
set -g status-left '#[fg=colour233,bg=colour245,bold] #S #[default] '

# Right status (date and time)
set -g status-right '#[fg=colour233,bg=colour241,bold] %Y-%m-%d #[fg=colour233,bg=colour245,bold] %H:%M:%S '
set -g status-right-length 50

# Window status format
setw -g window-status-current-style fg=colour81,bg=colour238,bold
setw -g window-status-current-format ' #I#[fg=colour250]:#[fg=colour255]#W#[fg=colour50]#F '

setw -g window-status-style fg=colour138,bg=colour235
setw -g window-status-format ' #I#[fg=colour237]:#[fg=colour250]#W#[fg=colour244]#F '

# Pane border colors
set -g pane-border-style fg=colour238
set -g pane-active-border-style fg=colour51

# Message colors
set -g message-style bg=colour235,fg=colour166
bind -r g display-popup -d '#{pane_current_path}' -w80% -h80% -E lazygit
# ============================================
# QUICK REFERENCE
# ============================================
# Leader: Ctrl+Space
#
# Panes:
#   | or v   : Split vertically
#   - or s   : Split horizontally
#   Alt+Arrow: Navigate panes (no prefix)
#   h,j,k,l  : Navigate panes (Vim-style)
#   H,J,K,L  : Resize panes
#   Shift+Arrow: Resize panes (no prefix)
#   x        : Close pane
#   z        : Zoom/unzoom pane
#
# Windows:
#   c        : Create window
#   Ctrl+h/l : Previous/next window (no prefix)
#   X        : Close window
#   r        : Rename window
#   < / >    : Move window left/right
#
# Sessions:
#   C        : Create session
#   S        : Switch session
#   d        : Detach
#
# Other:
#   R        : Reload config
#   [        : Copy mode
#   p        : Paste
#   b        : Toggle status bar
#   y        : Synchronize panes
# ============================================

# Plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'omerxx/tmux-sessionx'
set -g @plugin 'wfxr/tmux-power'
set -g @plugin 'wfxr/tmux-net-speed'
set -g @plugin 'tmux-plugins/tmux-battery'
set -g @plugin 'tmux-plugins/tmux-cpu'

# plugin specific configuration
set -g @sessionx-custom-paths '$HOME/.config/'
set -g @continuum-restore 'on'
set -g @resurrect-strategy-nvim 'session'
set -g @srcery_tmux_patched_font '1'

set -g @tmux_power_theme 'everforest'
set -g @tmux_power_date_icon           ''
set -g @tmux_power_time_icon           ''
set -g @tmux_power_user_icon           ''
set -g @tmux_power_session_icon        ''
set -g @tmux_power_right_arrow_icon    ''
set -g @tmux_power_left_arrow_icon     ''
set -g @tmux_power_upload_speed_icon   '󰕒'
set -g @tmux_power_download_speed_icon '󰇚'
set -g @tmux_power_date_format '%a, %d %h'
set -g @tmux_power_time_format '%T'
set -g @tmux_power_show_user    true
set -g @tmux_power_show_host    false
set -g @tmux_power_show_session true
set -g @tmux_power_show_upload_speed   false
set -g @tmux_power_show_download_speed true
set -g @tmux_power_prefix_highlight_pos 'LR'
set -g @tmux_power_show_web_reachable false
# RS="#[fg=$TC,bg=$G2]$larrow#[fg=$G0,bg=$TC] $date_icon $date_format #[fg=$G2]$larrow#[fg=$TC,bg=$G2] #{battery_status_bg} #{battery_icon} #{battery_percentage} #{battery_remain} | CPU #{cpu_icon} #{cpu_percentage} #{cpu_temp_icon} #{cpu_temp} | RAM #{ram_icon} #{ram_percentage}  #[fg=$G2]$larrow"

run '~/.config/tmux/plugins/tpm/tpm'
